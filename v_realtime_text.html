<!DOCTYPE html>
<html>
    <head>
        <title>My first Vue app</title>
        <script src="https://unpkg.com/vue"></script>
	<style>
	    .hello {
		font-size:20pt;
		font-weight:bold;
		border:1px solid magenta;
		padding:5px 10px 0px 10px;
		margin:10px;
	    }
	</style>
    </head>
    <body>
        <h1>Vue.js</h1>
        <div id="app">
	    <hello />
        </div>

        <script>
            /* use v attribute */
	    var keyPush = new Audio('');
	    var enterPush = new Audio('');

	    keyPush.src = "typewriter.mp3";
	    keyPush.load();

	    enterPush.src = "rupanIcatch.wav";
	    enterPush.load();

	    var hello = Vue.component('hello',
	    {
		    data:function(){
			return {
			    word:'',
			    composing:false,
			};
		    },
		    methods:{
		    	write:function(event) {
			    if(event.inputType == undefined || event.inputType === "deleteContentBackward"){
				return;
			    } else {
			    	keyPush.currentTime = 0;
			    	keyPush.play();
			    }
			    this.word = event.target.value;
			},
			isEnter:async function(event) {
			    if(!this.composing){
				enterPush.currentTime = 0.5;
			        enterPush.play();
				const res = await this.donotWrite(enterPush);
				this.word = res;
				console.log(res);
			    }
			},
			donotWrite:function(aud) {
				return new Promise((resolve) => {
			    	    aud.addEventListener('ended',(event)=>{
		    			resolve('done');
			    	    });
				});
			}
		    },
		    template: `<div>
			    	<p class="hello">{{word}}!</p>
			    	<div>
			    	    <input type="text" 
				    	@keydown.enter="isEnter"
					@compositionstart="composing=true"
					@compositionend="composing=false"
				    	v-on:input="write" 
					v-model="word"
				    >
			    	</div>
			       </div>`,
	    });

            var app = new Vue({
                el: '#app',
            });

        </script>
    </body>
</html>
